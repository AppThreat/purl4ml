{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/huggingface-extended-definition.json",
  "type": "huggingface",
  "type_name": "HuggingFace models",
  "description": "Hugging Face ML models",
  "uri_compliance": {
    "namespace_encoding": "verbatim",
    "name_encoding": "verbatim",
    "version_encoding": "lowercase"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://huggingface.co",
    "note": "The default repository is https://huggingface.co."
  },
  "namespace_definition": {
    "requirement": "optional",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "model repository username or organization",
    "note": "The namespace is the model repository username or organization. It is optional for official models. It is case-sensitive."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "model repository name",
    "note": "The name is the model repository name. It is case-sensitive. For a path like 'a/b', the name is 'b'. For a path like 'a', the name is 'a'."
  },
  "version_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "model revision Git commit hash",
    "note": "The version is the model revision Git commit hash. It is required for unambiguous identification and must be lowercased in the PURL.",
    "normalization_rules": [
      "It is not case sensitive and must be lowercased."
    ]
  },
  "qualifiers_definition": [
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "The base URL for a custom HuggingFace repository instance.",
      "examples": ["https://hub-ci.huggingface.co"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "case_sensitive": true,
      "examples_valid": ["microsoft", "facebook", "google"],
      "examples_invalid": ["microsoft/"]
    },
    "name": {
      "case_sensitive": true,
      "examples_valid": ["distilbert-base-uncased", "deberta-v3-base", "roberta-base"],
      "examples_invalid": ["deberta-v3-base/"]
    },
    "version": {
      "format": "git-commit-hash",
      "lowercase_required": true,
      "examples_valid": ["043235d6088ecd3dd5fb5ca3592b6913fd516027", "559062ad13d311b87b2c455e67dcd5f1c8f65111"],
      "examples_invalid": ["043235D6088ECD3DD5FB5CA3592B6913FD516027", "latest", "main"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:huggingface/{name}@{version}",
      "description": "Official HuggingFace model reference (no namespace).",
      "example": "pkg:huggingface/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027"
    },
    {
      "pattern": "pkg:huggingface/{namespace}/{name}@{version}",
      "description": "HuggingFace model with a namespace.",
      "example": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111"
    }
  ],
  "anti_patterns": [
    "pkg:huggingface/microsoft/deberta-v3-base@559062AD13D311B87B2C455E67DCD5F1C8F65111",
    "pkg:huggingface/microsoft/deberta-v3-base",
    "pkg:huggingface/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there only a single path segment?",
        "yes": "The segment is the name; there is no namespace.",
        "no": "Proceed with the next steps."
      },
      {
        "question": "Are there multiple path segments?",
        "yes": "The segment is the name; there is no namespace.",
        "no": "The last segment is the name; all preceding segments joined by '/' form the namespace."
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version and lowercase it.",
        "no": "Invalid PURL - version is required."
      }
    ]
  },
  "context": {
    "ecosystem": "Machine Learning",
    "package_manager": "HuggingFace Hub",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:huggingface/[{namespace}/]{name}@{version}[?{qualifiers}]",
    "versioning_system": "Git commit hashes",
    "case_sensitivity": "Namespace and name are case-sensitive; version is case-insensitive (normalized to lowercase)."
  },
  "edge_cases": [
    {
      "case": "Official models without a namespace",
      "handling": "These models have a name component but no namespace component.",
      "purl_impact": "e.g., pkg:huggingface/bert-base-uncased@..."
    },
    {
      "case": "Models from custom repositories",
      "handling": "Use the 'repository_url' qualifier to specify a non-default repository URL.",
      "purl_impact": "Allows referencing models from private or alternative HuggingFace instances."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "All HuggingFace models have a namespace.",
      "Model names are case-insensitive.",
      "Version can be omitted."
    ],
    "key_facts_to_remember": [
      "Namespace is optional and is used for non-official models.",
      "Name is required and is case-sensitive.",
      "Version is required and represents a Git commit hash (must be lowercase).",
      "The 'repository_url' qualifier can be used for non-default repositories."
    ],
    "common_mistakes_to_avoid": [
      "Assuming a namespace is required for all models.",
      "Using uppercase letters in the version (must be lowercase).",
      "Omitting the required version component.",
      "Changing the case of the namespace or name."
    ]
  },
  "examples": [
    {
      "purl": "pkg:huggingface/distilbert-base-uncased@043235d6088ecd3dd5fb5ca3592b6913fd516027",
      "description": "DistilBERT base uncased model (no namespace)."
    },
    {
      "purl": "pkg:huggingface/microsoft/deberta-v3-base@559062ad13d311b87b2c455e67dcd5f1c8f65111?repository_url=https://hub-ci.huggingface.co",
      "description": "Microsoft DeBERTa v3 base model from a CI repository."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:huggingface/microsoft/deberta-v3-base@559062AD13D311B87B2C455E67DCD5F1C8F65111",
      "description": "Version contains uppercase letters, which violates the lowercase requirement.",
      "violation": "version_definition requires lowercasing."
    },
    {
      "purl": "pkg:huggingface/microsoft/deberta-v3-base",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:huggingface/",
      "description": "Missing name component, which is required.",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "HuggingFace Hub",
      "url": "https://huggingface.co/docs/hub/index"
    },
    {
      "title": "HuggingFace Models",
      "url": "https://huggingface.co/models"
    },
    {
      "title": "HuggingFace Hub API",
      "url": "https://huggingface.co/docs/hub/api"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}
