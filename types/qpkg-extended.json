{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/qpkg-extended-definition.json",
  "type": "qpkg",
  "type_name": "QNX package",
  "description": "QNX packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "note": "There is no default package repository. The repository should be implied from the namespace (vendor) or explicitly provided using the 'repository_url' qualifier.",
    "supported_qualifiers": [
      "repository_url"
    ]
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "vendor",
    "note": "The namespace is the vendor of the package. It must be present and lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "name",
    "note": "The name is the package name. It is case-sensitive."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version, which may include timestamps and other identifiers."
  },
  "subpath_definition": {
    "requirement": "prohibited",
    "note": "The subpath component is not used for the qpkg type."
  },
  "qualifiers_definition": [
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "The base URL of the package repository where this package can be found.",
      "examples": ["https://qnx-repository.example.com/"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "examples_valid": ["blackberry", "qnx", "vendor"],
      "examples_invalid": ["BlackBerry", "QNX", "vendor/"]
    },
    "name": {
      "examples_valid": ["com.qnx.sdp", "com.qnx.qnx710.foo.bar.qux", "com.qnx.Sdp"],
      "examples_invalid": ["", "com.qnx.sdp/", "com.qnx.sdp@name"]
    },
    "version": {
      "format": "qnx-version",
      "examples_valid": ["7.0.0.SGA201702151847", "0.0.4.01449T202205040833L"],
      "examples_invalid": ["", "latest", "v7.0.0.SGA201702151847"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:qpkg/{vendor}/{name}@{version}",
      "description": "Standard QNX package reference",
      "example": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847"
    },
    {
      "pattern": "pkg:qpkg/{vendor}/{name}@{version}?repository_url={url}",
      "description": "QNX package with a specified repository",
      "example": "pkg:qpkg/blackberry/com.qnx.qnx710.foo.bar.qux@0.0.4.01449T202205040833L?repository_url=https://qnx-repository.example.com/"
    }
  ],
  "anti_patterns": [
    "pkg:qpkg/BlackBerry/com.qnx.sdp@7.0.0.SGA201702151847",
    "pkg:qpkg/blackberry/com.qnx.sdp",
    "pkg:qpkg/blackberry/com.qnx.sdp@",
    "pkg:qpkg/blackberry/",
    "pkg:qpkg/",
    "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0#subpath"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a vendor (namespace) component?",
        "yes": "Extract the vendor (first component after pkg:qpkg/) and lowercase it.",
        "no": "Invalid PURL - vendor is required for qpkg."
      },
      {
        "question": "Is there a package name component?",
        "yes": "Extract the package name (component after vendor/).",
        "no": "Invalid PURL - name is required for qpkg."
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version.",
        "no": "Invalid PURL - version is required for qpkg."
      },
      {
        "question": "Is there a subpath component?",
        "yes": "Invalid PURL - subpath is prohibited for qpkg.",
        "no": "Proceed with qualifier parsing."
      }
    ]
  },
  "context": {
    "ecosystem": "QNX",
    "package_manager": "QNX Software Manager",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:qpkg/{vendor}/{name}@{version}?{qualifiers}",
    "versioning_system": "QNX-specific versioning with timestamps",
    "naming_convention": "Dot-separated package names with a vendor prefix",
    "repository_model": "Distributed with no central default repository"
  },
  "edge_cases": [
    {
      "case": "Version strings containing timestamps or build metadata",
      "handling": "The entire string is treated as the version. No parsing or normalization is applied.",
      "purl_impact": "Ensures complete and accurate version information is preserved."
    },
    {
      "case": "Disambiguating packages from different repositories",
      "handling": "The optional 'repository_url' qualifier should be used to specify the package's origin.",
      "purl_impact": "Provides necessary context when a vendor might publish to multiple, distinct repositories."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "A vendor/namespace is optional.",
      "Package names are case-insensitive.",
      "The version can be omitted.",
      "There is a central, default package repository.",
      "Versions follow SemVer."
    ],
    "key_facts_to_remember": [
      "A vendor is required and must be lowercase.",
      "A name is required and is case-sensitive.",
      "A version is required and has a proprietary format.",
      "The 'repository_url' qualifier is used to specify the repository.",
      "The subpath component is not used."
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in the vendor name.",
      "Omitting the required version or name components.",
      "Forgetting to include the vendor component.",
      "Assuming a default repository URL.",
      "Adding a subpath."
    ]
  },
  "examples": [
    {
      "purl": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847",
      "description": "QNX SDP package from BlackBerry"
    },
    {
      "purl": "pkg:qpkg/blackberry/com.qnx.qnx710.foo.bar.qux@0.0.4.01449T202205040833L",
      "description": "QNX package with complex name and timestamped version"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:qpkg/BlackBerry/com.qnx.sdp@7.0.0.SGA201702151847",
      "description": "Vendor contains uppercase letters.",
      "violation": "namespace_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:qpkg/blackberry/com.qnx.sdp",
      "description": "Missing version component.",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:qpkg/blackberry/",
      "description": "Missing name and version components.",
      "violation": "name_definition.requirement=required"
    },
    {
      "purl": "pkg:qpkg/blackberry/com.qnx.sdp@7.0.0.SGA201702151847#sub/path",
      "description": "Contains a subpath component.",
      "violation": "subpath_definition.requirement=prohibited"
    }
  ],
  "references": [
    {
      "title": "QNX Documentation",
      "url": "https://www.qnx.com/developers/docs/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}