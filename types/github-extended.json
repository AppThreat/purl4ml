{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/github-extended-definition.json",
  "type": "github",
  "type_name": "GitHub",
  "description": "GitHub-based packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "lowercase",
    "version_encoding": "verbatim",
    "subpath_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://github.com",
    "supported_repositories": [
      "https://github.com"
    ],
    "note": "GitHub packages are hosted on GitHub repositories"
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "user or organization",
    "note": "The namespace is the user or organization. It is not case sensitive and must be lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "repository name",
    "note": "The name is the repository name. It is not case sensitive and must be lowercased."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "commit or tag",
    "note": "The version is a commit or tag."
  },
  "subpath_definition": {
    "requirement": "optional",
    "encoding": "verbatim",
    "native_name": "subpath",
    "note": "The subpath can be used to reference specific files or directories within the repository."
  },
  "qualifiers_definition": [
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "Custom GitHub Enterprise URL",
      "examples": ["https://github.enterprise.com"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["package-url", "microsoft", "google"],
      "examples_invalid": ["Package-URL", "package url", "package@url"]
    },
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["purl-spec", "vscode", "tensorflow"],
      "examples_invalid": ["PURL-SPEC", "purl spec", "purl@spec"]
    },
    "version": {
      "format": "commit-hash-or-tag",
      "examples_valid": ["244fd47e07d1004", "v1.0.0", "main"],
      "examples_invalid": ["", "latest", "v1.0.0@"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:github/{user}/{repo}@{commit}",
      "description": "Standard GitHub repository with commit hash",
      "example": "pkg:github/package-url/purl-spec@244fd47e07d1004"
    },
    {
      "pattern": "pkg:github/{user}/{repo}@{commit}#{subpath}",
      "description": "GitHub repository with commit hash and subpath",
      "example": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs"
    }
  ],
  "anti_patterns": [
    "pkg:github/Package-URL/purl-spec@244fd47e07d1004",
    "pkg:github/package-url/PURL-SPEC@244fd47e07d1004",
    "pkg:github/package-url/purl-spec",
    "pkg:github/package-url",
    "pkg:github"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a user/organization component?",
        "yes": "Extract the user/organization (first component after pkg:github/)",
        "no": "Invalid PURL - user/organization is required for github"
      },
      {
        "question": "Is there a repository name component?",
        "yes": "Extract the repository name (component after user/)",
        "no": "Invalid PURL - repository name is required for github"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for github"
      },
      {
        "question": "Is there a subpath component?",
        "yes": "Extract everything after # as subpath",
        "no": "No subpath present"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?",
        "no": "No qualifiers present"
      }
    ]
  },
  "context": {
    "ecosystem": "GitHub",
    "package_manager": "Git",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:github/{user}/{repo}@{version}[#{subpath}][?{qualifiers}]",
    "versioning_system": "Git commit hashes or tags",
    "repository_model": "Centralized with GitHub as default",
    "enterprise_support": "GitHub Enterprise supported via repository_url qualifier"
  },
  "edge_cases": [
    {
      "case": "GitHub Enterprise instances",
      "handling": "Use repository_url qualifier to specify non-github.com instance",
      "purl_impact": "Allows referencing packages from enterprise GitHub installations"
    },
    {
      "case": "Repository names with special characters",
      "handling": "Special characters must be URL-encoded in the PURL",
      "purl_impact": "Ensures proper parsing of repositories with special characters"
    },
    {
      "case": "Branch names as versions",
      "handling": "Branch names can be used as version identifiers",
      "purl_impact": "Enables referencing the latest state of a branch"
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "All GitHub packages are on github.com",
      "Repository names can contain uppercase letters",
      "Version can be omitted",
      "User/organization names can contain spaces",
      "Branch names cannot be used as versions"
    ],
    "key_facts_to_remember": [
      "User/organization is required and must be lowercase",
      "Repository name is required and must be lowercase",
      "Version is required and can be a commit hash or tag",
      "Subpath is optional for referencing specific files/directories",
      "GitHub Enterprise instances use repository_url qualifier"
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in user/organization or repository name",
      "Omitting the required version component",
      "Forgetting to encode special characters",
      "Confusing with Bitbucket PURLs",
      "Assuming all packages are on github.com"
    ]
  },
  "examples": [
    {
      "purl": "pkg:github/package-url/purl-spec@244fd47e07d1004",
      "description": "Package URL specification repository with commit hash"
    },
    {
      "purl": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs",
      "description": "Package URL specification repository with commit hash and subpath"
    },
    {
      "purl": "pkg:github/microsoft/vscode@1.70.0",
      "description": "VS Code repository with version tag"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:github/Package-URL/purl-spec@244fd47e07d1004",
      "description": "User/organization with uppercase letters - violates lowercase requirement",
      "violation": "namespace_definition.case_sensitive=false and namespace_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:github/package-url/PURL-SPEC@244fd47e07d1004",
      "description": "Repository name with uppercase letters - violates lowercase requirement",
      "violation": "name_definition.case_sensitive=false and name_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:github/package-url/purl-spec",
      "description": "Missing version component - version is required for github",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:github/package-url",
      "description": "Missing repository name component - repository name is required for github",
      "violation": "name_definition.requirement=required"
    },
    {
      "purl": "pkg:github",
      "description": "Missing user/organization component - user/organization is required for github",
      "violation": "namespace_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "GitHub Documentation",
      "url": "https://docs.github.com/"
    },
    {
      "title": "GitHub REST API",
      "url": "https://docs.github.com/en/rest"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-16"
  }
}