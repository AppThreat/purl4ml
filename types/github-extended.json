{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/github-extended-definition.json",
  "type": "github",
  "type_name": "GitHub",
  "description": "GitHub-based packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "lowercase",
    "version_encoding": "verbatim",
    "subpath_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://github.com",
    "supported_repositories": [
      "https://github.com"
    ],
    "note": "GitHub PURLs refer to repositories hosted on GitHub.com."
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "user or organization",
    "note": "The namespace is the user or organization. It is not case sensitive and must be lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "repository name",
    "note": "The name is the repository name. It is not case sensitive and must be lowercased."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "commit or tag",
    "note": "The version is a commit hash, tag, or branch name."
  },
  "subpath_definition": {
    "requirement": "optional",
    "encoding": "verbatim",
    "native_name": "subpath",
    "note": "The subpath, represented as the URI fragment, can be used to reference specific files or directories within the repository."
  },
  "qualifiers_definition": [],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["package-url", "microsoft", "google"],
      "examples_invalid": ["Package-URL", "package url", "package@url"]
    },
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["purl-spec", "vscode", "tensorflow"],
      "examples_invalid": ["PURL-SPEC", "purl spec", "purl@spec"]
    },
    "version": {
      "format": "commit-hash-or-tag",
      "examples_valid": ["244fd47e07d1004", "v1.0.0", "main"],
      "examples_invalid": [""]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:github/{user}/{repo}@{commit}",
      "description": "Standard GitHub repository with a commit hash or tag.",
      "example": "pkg:github/package-url/purl-spec@244fd47e07d1004"
    },
    {
      "pattern": "pkg:github/{user}/{repo}@{commit}#{subpath}",
      "description": "GitHub repository with a commit hash and subpath.",
      "example": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs"
    }
  ],
  "anti_patterns": [
    "pkg:github/Package-URL/purl-spec@244fd47e07d1004",
    "pkg:github/package-url/PURL-SPEC@244fd47e07d1004",
    "pkg:github/package-url/purl-spec",
    "pkg:github/package-url/purl-spec@244fd47e07d1004?repository_url=foo.com"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a user/organization component?",
        "yes": "Extract the user/organization (first component after pkg:github/)",
        "no": "Invalid PURL - user/organization is required"
      },
      {
        "question": "Is there a repository name component?",
        "yes": "Extract the repository name (component after user/)",
        "no": "Invalid PURL - repository name is required"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required"
      },
      {
        "question": "Is there a subpath (fragment) component?",
        "yes": "Extract everything after # as subpath",
        "no": "No subpath present."
      }
    ]
  },
  "context": {
    "ecosystem": "GitHub",
    "package_manager": "Git",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:github/{user}/{repo}@{version}[#{subpath}]",
    "versioning_system": "Git commit hashes, tags, or branch names",
    "repository_model": "Centralized on GitHub.com."
  },
  "edge_cases": [
    {
      "case": "Subpath to a file or directory",
      "handling": "Use the fragment (#) portion of the PURL to specify a path within the repository.",
      "purl_impact": "Allows referencing files or directories at a specific commit."
    },
    {
      "case": "Branch names as versions",
      "handling": "Branch names like 'main' or 'develop' can be used as version identifiers.",
      "purl_impact": "Enables referencing the latest commit of a specific branch."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "GitHub PURLs can point to Enterprise instances.",
      "Repository names can contain uppercase letters.",
      "Version can be omitted."
    ],
    "key_facts_to_remember": [
      "User/organization is required and must be lowercase.",
      "Repository name is required and must be lowercase.",
      "Version is required and can be a commit hash, tag, or branch name.",
      "The subpath (after a #) is optional for referencing specific files/directories.",
      "There are no qualifiers for the GitHub PURL type."
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in the user/organization or repository name.",
      "Omitting the required version component.",
      "Trying to use a 'repository_url' qualifier, which is not supported."
    ]
  },
  "examples": [
    {
      "purl": "pkg:github/package-url/purl-spec@244fd47e07d1004",
      "description": "Package URL specification repository with a commit hash."
    },
    {
      "purl": "pkg:github/package-url/purl-spec@244fd47e07d1004#everybody/loves/dogs",
      "description": "Package URL specification repository with a commit hash and subpath."
    },
    {
      "purl": "pkg:github/microsoft/vscode@v1.70.0",
      "description": "VS Code repository with a version tag."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:github/Package-URL/purl-spec@244fd47e07d1004",
      "description": "User/organization contains uppercase letters, which violates the lowercase requirement.",
      "violation": "namespace_definition requires lowercasing."
    },
    {
      "purl": "pkg:github/package-url/PURL-SPEC@244fd47e07d1004",
      "description": "Repository name contains uppercase letters, which violates the lowercase requirement.",
      "violation": "name_definition requires lowercasing."
    },
    {
      "purl": "pkg:github/package-url/purl-spec",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:github/package-url",
      "description": "Missing repository name component, which is required.",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "GitHub Documentation",
      "url": "https://docs.github.com/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}