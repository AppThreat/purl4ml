{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/mlflow-extended-definition.json",
  "type": "mlflow",
  "type_name": "MLflow ML models",
  "description": "MLflow ML models (Azure ML, Databricks, etc.)",
  "uri_compliance": {
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "note": "The repository is the MLflow tracking URI. There is no default. Some examples include Azure ML https://<region>.api.azureml.ms/mlflow/v1.0/subscriptions/<subscription-id>/resourceGroups/<resource-group-name>/providers/Microsoft.MachineLearningServices/workspaces/<workspace-name> and Azure Databricks https://adb-<numbers>.<number>.azuredatabricks.net/api/2.0/mlflow and AWS Databricks https://dbc-<alphanumeric>-<alphanumeric>.cloud.databricks.com/api/2.0/mlflow and GCP Databricks https://<numbers>.<number>.gcp.databricks.com/api/2.0/mlflow",
    "supported_qualifiers": [
      "repository_url"
    ]
  },
  "namespace_definition": {
    "requirement": "prohibited",
    "note": "there is no namespace"
  },
  "name_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "model name",
    "note": "The name is the model name. Case sensitivity depends on the server implementation, such as for Azure ML, it is case sensitive and must be kept as-is in the package URL; and for Databricks, it is case insensitive and must be lowercased in the package URL."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the model version."
  },
  "qualifiers_definition": [
    {
      "key": "model_uuid",
      "requirement": "optional",
      "native_name": "model_uuid",
      "description": "model_uuid as defined in the MLflow documentation.",
      "examples": ["36233173b22f4c89b451f1228d700d49"]
    },
    {
      "key": "run_id",
      "requirement": "optional",
      "native_name": "run_id",
      "description": "run_id as defined in the MLflow documentation.",
      "examples": ["410a3121-2709-4f88-98dd-dba0ef056b0a"]
    },
    {
      "key": "repository_url",
      "requirement": "required",
      "description": "The MLflow tracking URI. This qualifier is required as there is no default repository.",
      "examples": [
        "https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
        "https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow"
      ]
    }
  ],
  "validation_rules": {
    "name": {
      "examples_valid": ["creditfraud", "trafficsigns", "MyModel"],
      "examples_invalid": ["model/name", "model@name"]
    },
    "version": {
      "examples_valid": ["3", "10", "1.0"],
      "examples_invalid": ["latest", "v3"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:mlflow/{name}@{version}?repository_url={url}",
      "description": "MLflow model with a repository URL.",
      "example": "pkg:mlflow/creditfraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace"
    },
    {
      "pattern": "pkg:mlflow/{name}@{version}?model_uuid={uuid}&run_id={id}&repository_url={url}",
      "description": "MLflow model with UUID, run ID, and repository URL.",
      "example": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow"
    }
  ],
  "anti_patterns": [
    "pkg:mlflow/namespace/creditfraud@3?repository_url=https://...",
    "pkg:mlflow/creditfraud@latest?repository_url=https://...",
    "pkg:mlflow/creditfraud@3",
    "pkg:mlflow/creditfraud@3?repository_url=",
    "pkg:mlflow/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Invalid PURL - namespace is prohibited",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a model name component?",
        "yes": "Extract the name",
        "no": "Invalid PURL - name is required"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required"
      },
      {
        "question": "Is there a 'repository_url' qualifier?",
        "yes": "Parse qualifiers.",
        "no": "Invalid PURL - 'repository_url' is a required qualifier."
      }
    ]
  },
  "context": {
    "ecosystem": "Machine Learning",
    "package_manager": "MLflow",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:mlflow/{name}@{version}?{qualifiers}",
    "versioning_system": "Numeric model versions",
    "repository_model": "Distributed. The 'repository_url' qualifier is required to specify the MLflow tracking URI."
  },
  "edge_cases": [
    {
      "case": "Case sensitivity in model names",
      "handling": "Case sensitivity depends on the server implementation (e.g., Azure ML is case-sensitive, Databricks is not). The PURL must reflect the exact casing expected by the target repository.",
      "purl_impact": "The 'name' component must be preserved verbatim. Consumers of the PURL must know the target system's rules."
    },
    {
      "case": "Multiple MLflow platforms",
      "handling": "Use the required 'repository_url' qualifier to specify the MLflow tracking URI.",
      "purl_impact": "Enables referencing models from different MLflow implementations."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "MLflow models have namespaces.",
      "The 'repository_url' qualifier is optional.",
      "The version can be omitted."
    ],
    "key_facts_to_remember": [
      "Namespace is prohibited.",
      "The model name is required, and its case sensitivity depends on the platform.",
      "The version is required.",
      "The 'repository_url' qualifier is required.",
      "The 'model_uuid' and 'run_id' qualifiers are optional."
    ],
    "common_mistakes_to_avoid": [
      "Adding a namespace component.",
      "Omitting the required version component.",
      "Forgetting to include the required 'repository_url' qualifier."
    ]
  },
  "examples": [
    {
      "purl": "pkg:mlflow/creditfraud@3?repository_url=https://westus2.api.azureml.ms/mlflow/v1.0/subscriptions/a50f2011-fab8-4164-af23-c62881ef8c95/resourceGroups/TestResourceGroup/providers/Microsoft.MachineLearningServices/workspaces/TestWorkspace",
      "description": "Credit fraud model from Azure ML."
    },
    {
      "purl": "pkg:mlflow/trafficsigns@10?model_uuid=36233173b22f4c89b451f1228d700d49&run_id=410a3121-2709-4f88-98dd-dba0ef056b0a&repository_url=https://adb-5245952564735461.0.azuredatabricks.net/api/2.0/mlflow",
      "description": "Traffic signs model from Azure Databricks with UUID and run ID."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:mlflow/namespace/creditfraud@3?repository_url=https://...",
      "description": "Includes a namespace component, which is prohibited.",
      "violation": "namespace_definition.requirement=prohibited"
    },
    {
      "purl": "pkg:mlflow/creditfraud@latest?repository_url=https://...",
      "description": "Non-specific version. 'latest' is not a valid MLflow version.",
      "violation": "version_definition requires a specific version."
    },
    {
      "purl": "pkg:mlflow/creditfraud@3",
      "description": "Missing the 'repository_url' qualifier, which is required.",
      "violation": "qualifiers_definition.repository_url.requirement=required"
    },
    {
      "purl": "pkg:mlflow/creditfraud@3?repository_url=",
      "description": "Empty repository_url qualifier value. If a key is present, its value must not be empty.",
      "violation": "Qualifiers must have a non-empty value."
    }
  ],
  "references": [
    {
      "title": "MLflow Documentation",
      "url": "https://mlflow.org/docs/latest/index.html"
    },
    {
      "title": "Azure ML MLflow",
      "url": "https://docs.microsoft.com/en-us/azure/machine-learning/how-to-use-mlflow"
    },
    {
      "title": "Databricks MLflow",
      "url": "https://docs.databricks.com/applications/mlflow/index.html"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}