{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/maven-extended-definition.json",
  "type": "maven",
  "type_name": "Maven",
  "description": "PURL type for Maven JARs and related artifacts.",
  "uri_compliance": {
    "namespace_encoding": "verbatim",
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://repo.maven.apache.org/maven2/",
    "supported_repositories": [
      "https://repo.maven.apache.org/maven2/",
      "https://repo1.maven.org/maven2/",
      "https://maven.google.com"
    ],
    "note": "The Maven Central repository is the public repository for Apache Maven packages. This repository is also mirrored at https://repo1.maven.org/maven2/. Use the standard repository_url qualifier to point to another repository"
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "groupId",
    "note": "The group id is the namespace."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "artifactId",
    "note": "The artifact id is the name."
  },
  "version_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version."
  },
  "qualifiers_definition": [
    {
      "key": "classifier",
      "requirement": "optional",
      "description": "The maven classifier as defined in the POM documentation.",
      "native_name": "classifier",
      "examples": ["sources", "javadoc", "dist", "x86", "x64"]
    },
    {
      "key": "type",
      "requirement": "optional",
      "description": "The maven type as defined in the POM documentation. Note that Maven uses a concept / coordinate called packaging which does not map directly 1:1 to a file extension. In this use case, we need to construct a link to one of many possible artifacts. Maven itself uses type in a dependency declaration when needed to disambiguate between them.",
      "native_name": "type",
      "default_value": "jar",
      "examples": ["jar", "pom", "zip", "dll", "war"]
    },
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "Custom Maven repository URL",
      "examples": ["https://maven.google.com", "https://repo.spring.io/release"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "case_sensitive": true,
      "dot_notation": true,
      "examples_valid": ["org.apache.xmlgraphics", "net.sf.jacob-projec", "groovy"],
      "examples_invalid": ["", "org.apache.xmlgraphics/", "org.apache.xmlgraphics@xml"]
    },
    "name": {
      "case_sensitive": true,
      "examples_valid": ["batik-anim", "jacob", "groovy"],
      "examples_invalid": ["", "batik-anim/", "batik@anim"]
    },
    "version": {
      "case_sensitive": true,
      "examples_valid": ["1.9.1", "1.14.3", "1.0"],
      "examples_invalid": ["", "latest", "v1.9.1"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}",
      "description": "Standard Maven artifact reference",
      "example": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?type={type}",
      "description": "Maven artifact with specific type",
      "example": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?classifier={classifier}",
      "description": "Maven artifact with classifier",
      "example": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?type={type}&classifier={classifier}",
      "description": "Maven artifact with both type and classifier",
      "example": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=zip&classifier=dist"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?classifier={classifier}&type={type}",
      "description": "Maven artifact with classifier and type for native libraries",
      "example": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x86&type=dll"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?repository_url={url}",
      "description": "Maven artifact from custom repository",
      "example": "pkg:maven/groovy/groovy@1.0?repository_url=https://maven.google.com"
    }
  ],
  "anti_patterns": [
    "pkg:maven/org.apache.xmlgraphics/batik-anim@latest",
    "pkg:maven/org.apache.xmlgraphics/Batik-anim@1.9.1",
    "pkg:maven/org.apache.xmlgraphics/batik-anim",
    "pkg:maven/org.apache.xmlgraphics/batik-anim@",
    "pkg:maven/org.apache.xmlgraphics/",
    "pkg:maven/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a groupId component?",
        "yes": "Extract the groupId (first component after pkg:maven/)",
        "no": "Invalid PURL - groupId is required for maven"
      },
      {
        "question": "Is there an artifactId component?",
        "yes": "Extract the artifactId (component after groupId/)",
        "no": "Invalid PURL - artifactId is required for maven"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for maven"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?",
        "no": "No qualifiers present (type defaults to jar)"
      }
    ]
  },
  "context": {
    "ecosystem": "Java",
    "package_manager": "Maven",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:maven/{groupId}/{artifactId}@{version}?{qualifiers}",
    "versioning_system": "Maven versioning",
    "coordinate_system": " groupId, artifactId, version, classifier, type",
    "repository_model": "Centralized with Maven Central as default, supports custom repositories"
  },
  "edge_cases": [
    {
      "case": "Native libraries with platform-specific classifiers",
      "handling": "Use classifier and type qualifiers to specify platform and artifact type",
      "purl_impact": "Enables precise reference to platform-specific native libraries"
    },
    {
      "case": "Multiple artifact types for same GAV",
      "handling": "Use type qualifier to distinguish between different artifact types",
      "purl_impact": "Allows disambiguation between JAR, POM, WAR, and other artifact types"
    },
    {
      "case": "Artifacts from custom repositories",
      "handling": "Use repository_url qualifier to specify non-default repository",
      "purl_impact": "Enables referencing artifacts from enterprise or alternative Maven repositories"
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "Maven artifacts don't require groupId",
      "Artifact names are case-insensitive",
      "Version can be omitted",
      "All artifacts are JAR files",
      "All artifacts are on Maven Central"
    ],
    "key_facts_to_remember": [
      "GroupId is required and represents the namespace",
      "ArtifactId is required and represents the name",
      "Version is required and case-sensitive",
      "Type qualifier defaults to 'jar' when not specified",
      "Classifier is used to distinguish secondary artifacts"
    ],
    "common_mistakes_to_avoid": [
      "Omitting any of the required components (groupId, artifactId, version)",
      "Using 'latest' as version (not a specific version)",
      "Changing case of groupId or artifactId",
      "Forgetting that type defaults to jar",
      "Confusing classifier with type"
    ]
  },
  "examples": [
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1",
      "description": "Batik animation library JAR"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom",
      "description": "Batik animation library POM file"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources",
      "description": "Batik animation library sources JAR"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=zip&classifier=dist",
      "description": "Batik animation library distribution ZIP"
    },
    {
      "purl": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x86&type=dll",
      "description": "JACOB library x86 DLL"
    },
    {
      "purl": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x64&type=dll",
      "description": "JACOB library x64 DLL"
    },
    {
      "purl": "pkg:maven/groovy/groovy@1.0?repository_url=https://maven.google.com",
      "description": "Groovy library from Google Maven repository"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@latest",
      "description": "Non-specific version - 'latest' is not a valid Maven version",
      "violation": "version_definition requires a specific version"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/Batik-anim@1.9.1",
      "description": "ArtifactId with incorrect case - artifactId is case-sensitive",
      "violation": "name_definition.case_sensitive=true"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim",
      "description": "Missing version component - version is required for maven",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@",
      "description": "Empty version component - version cannot be empty",
      "violation": "version_definition requires a valid version"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/",
      "description": "Missing artifactId component - artifactId is required for maven",
      "violation": "name_definition.requirement=required"
    },
    {
      "purl": "pkg:maven/",
      "description": "Missing groupId and artifactId components - both are required for maven",
      "violation": "namespace_definition.requirement=required and name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Maven Documentation",
      "url": "https://maven.apache.org/"
    },
    {
      "title": "Maven Central",
      "url": "https://repo.maven.apache.org/maven2/"
    },
    {
      "title": "Maven POM Reference",
      "url": "https://maven.apache.org/pom.html"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-16"
  }
}