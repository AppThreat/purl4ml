{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/maven-extended-definition.json",
  "type": "maven",
  "type_name": "Maven",
  "description": "PURL type for Maven JARs and related artifacts.",
  "uri_compliance": {
    "namespace_encoding": "verbatim",
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://repo.maven.apache.org/maven2/",
    "supported_repositories": [
      "https://repo.maven.apache.org/maven2/",
      "https://repo1.maven.org/maven2/",
      "https://maven.google.com"
    ],
    "note": "The Maven Central repository is the public repository for Apache Maven packages. This repository is also mirrored at https://repo1.maven.org/maven2/. Use the standard repository_url qualifier to point to another repository"
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "groupId",
    "note": "The group id is the namespace."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "artifactId",
    "note": "The artifact id is the name."
  },
  "version_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version."
  },
  "qualifiers_definition": [
    {
      "key": "classifier",
      "requirement": "optional",
      "description": "The maven classifier as defined in the POM documentation.",
      "native_name": "classifier",
      "examples": ["sources", "javadoc", "dist", "x86", "x64"]
    },
    {
      "key": "type",
      "requirement": "optional",
      "description": "The maven type as defined in the POM documentation. Note that Maven uses a concept / coordinate called packaging which does not map directly 1:1 to a file extension. In this use case, we need to construct a link to one of many possible artifacts. Maven itself uses type in a dependency declaration when needed to disambiguate between them.",
      "native_name": "type",
      "default_value": "jar",
      "examples": ["jar", "pom", "zip", "dll", "war"]
    },
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "The base URL of a non-default Maven repository.",
      "examples": ["https://maven.google.com", "https://repo.spring.io/release"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "case_sensitive": true,
      "dot_notation": true,
      "examples_valid": ["org.apache.xmlgraphics", "net.sf.jacob-projec", "groovy"],
      "examples_invalid": ["org.apache.xmlgraphics/"]
    },
    "name": {
      "case_sensitive": true,
      "examples_valid": ["batik-anim", "jacob", "groovy"],
      "examples_invalid": ["batik-anim/"]
    },
    "version": {
      "case_sensitive": true,
      "examples_valid": ["1.9.1", "1.14.3", "1.0"],
      "examples_invalid": ["latest", "v1.9.1"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}",
      "description": "Standard Maven artifact reference (defaults to type=jar).",
      "example": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?type={type}&classifier={classifier}",
      "description": "Maven artifact with both type and classifier.",
      "example": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=zip&classifier=dist"
    },
    {
      "pattern": "pkg:maven/{groupId}/{artifactId}@{version}?repository_url={url}",
      "description": "Maven artifact from a custom repository.",
      "example": "pkg:maven/groovy/groovy@1.0?repository_url=https://maven.google.com"
    }
  ],
  "anti_patterns": [
    "pkg:maven/org.apache.xmlgraphics/batik-anim@latest",
    "pkg:maven/org.apache.xmlgraphics/Batik-anim@1.9.1",
    "pkg:maven/org.apache.xmlgraphics/batik-anim",
    "pkg:maven/org.apache.xmlgraphics/batik-anim@"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a groupId component?",
        "yes": "Extract the groupId (first component after pkg:maven/)",
        "no": "Invalid PURL - groupId is required"
      },
      {
        "question": "Is there an artifactId component?",
        "yes": "Extract the artifactId (component after groupId/)",
        "no": "Invalid PURL - artifactId is required"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?.",
        "no": "No qualifiers present (type defaults to jar)."
      }
    ]
  },
  "context": {
    "ecosystem": "Java",
    "package_manager": "Maven",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:maven/{groupId}/{artifactId}@{version}?{qualifiers}",
    "versioning_system": "Maven versioning",
    "coordinate_system": "groupId, artifactId, version, classifier, type",
    "repository_model": "Centralized with Maven Central as the default, but supports custom repositories via the 'repository_url' qualifier."
  },
  "edge_cases": [
    {
      "case": "Artifacts from custom repositories",
      "handling": "Use the 'repository_url' qualifier to specify the base URL of a non-default Maven repository.",
      "purl_impact": "Enables referencing artifacts from enterprise or alternative Maven repositories."
    },
    {
      "case": "Native libraries with platform-specific classifiers",
      "handling": "Use the 'classifier' and 'type' qualifiers to specify the platform and artifact type.",
      "purl_impact": "Enables precise reference to platform-specific native libraries (e.g., ?classifier=x86&type=dll)."
    },
    {
      "case": "Multiple artifact types for the same GAV",
      "handling": "Use the 'type' qualifier to distinguish between different artifact types.",
      "purl_impact": "Allows disambiguation between JAR, POM, WAR, and other artifact types."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "The version can be omitted.",
      "The groupId or artifactId are case-insensitive.",
      "All artifacts are on Maven Central."
    ],
    "key_facts_to_remember": [
      "The groupId (namespace), artifactId (name), and version are all required and case-sensitive.",
      "The 'type' qualifier defaults to 'jar' if not specified.",
      "The 'classifier' is used to distinguish secondary artifacts.",
      "The 'repository_url' qualifier is used for non-default repositories."
    ],
    "common_mistakes_to_avoid": [
      "Omitting any of the required GAV components (groupId, artifactId, version).",
      "Changing the case of the groupId or artifactId.",
      "Forgetting that the default 'type' is 'jar'."
    ]
  },
  "examples": [
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1",
      "description": "Batik animation library JAR."
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?type=pom",
      "description": "Batik animation library POM file."
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@1.9.1?classifier=sources",
      "description": "Batik animation library sources JAR."
    },
    {
      "purl": "pkg:maven/net.sf.jacob-projec/jacob@1.14.3?classifier=x64&type=dll",
      "description": "JACOB library 64-bit DLL."
    },
    {
      "purl": "pkg:maven/groovy/groovy@1.0?repository_url=https://maven.google.com",
      "description": "Groovy library from the Google Maven repository."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim@latest",
      "description": "Non-specific version. 'latest' is not a valid Maven version string.",
      "violation": "version_definition requires a specific version."
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/Batik-anim@1.9.1",
      "description": "ArtifactId with incorrect case. It is case-sensitive.",
      "violation": "name_definition.case_sensitive=true"
    },
    {
      "purl": "pkg:maven/org.apache.xmlgraphics/batik-anim",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Maven Documentation",
      "url": "https://maven.apache.org/"
    },
    {
      "title": "Maven Central",
      "url": "https://repo.maven.apache.org/maven2/"
    },
    {
      "title": "Maven POM Reference",
      "url": "https://maven.apache.org/pom.html"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}