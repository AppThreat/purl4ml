{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/swid-extended-definition.json",
  "type": "swid",
  "type_name": "Software Identification (SWID) Tag",
  "description": "PURL type for ISO-IEC 19770-2 Software Identification (SWID) tags.",
  "uri_compliance": {
    "namespace_encoding": "verbatim",
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": false,
    "note": "There is no default package repository."
  },
  "namespace_definition": {
    "requirement": "optional",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "softwareCreator",
    "note": "The namespace is the optional name and regid of the entity with a role of softwareCreator. If specified, name is required and is the first segment in the namespace. If regid is known, it must be specified as the second segment in the namespace. A maximum of two segments are supported."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "SoftwareIdentity/name",
    "note": "The name is the name as defined in the SWID SoftwareIdentity element."
  },
  "version_definition": {
    "requirement": "optional",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "SoftwareIdentity/version",
    "note": "The version is the version as defined in the SWID SoftwareIdentity element."
  },
  "qualifiers_definition": [
    {
      "key": "tag_id",
      "requirement": "required",
      "description": "The qualifier tag_id must not be empty and corresponds to the tagId as defined in the SWID SoftwareIdentity element. Per the SWID specification, GUIDs are recommended. If a GUID is used, it must be lowercase. If a GUID is not used, the tag_id qualifier is case aware but not case sensitive.",
      "examples": ["75b8c285-fa7b-485b-b199-4745e3004d0d", "org.fedoraproject.Fedora-29", "CreativeCloud-CS6-Win-GM-MUL"]
    },
    {
      "key": "tag_version",
      "requirement": "optional",
      "description": "The qualifier tag_version is an optional integer and corresponds to the tagVersion as defined in the SWID SoftwareIdentity element. If not specified, defaults to 0.",
      "examples": ["0", "1", "2"]
    },
    {
      "key": "patch",
      "requirement": "optional",
      "description": "The qualifier patch is optional and corresponds to the patch as defined in the SWID SoftwareIdentity element. If not specified, defaults to false.",
      "examples": ["true", "false"]
    },
    {
      "key": "tag_creator_name",
      "requirement": "optional",
      "description": "The qualifier tag_creator_name is optional. If the tag creator is different from the software creator, the tag_creator_name qualifier should be specified.",
      "examples": ["Adobe Systems Incorporated", "Fedora Project"]
    },
    {
      "key": "tag_creator_regid",
      "requirement": "optional",
      "description": "The qualifier tag_creator_regid is optional. If the tag creator is different from the software creator, the tag_creator_regid qualifier should be specified.",
      "examples": ["adobe.com", "fedoraproject.org"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "case_sensitive": true,
      "max_segments": 2,
      "examples_valid": ["Acme/example.com", "Fedora", "Adobe+Systems+Incorporated"],
      "examples_invalid": ["", "Acme/example.com/extra", "Acme//example.com"]
    },
    "name": {
      "case_sensitive": true,
      "examples_valid": ["Enterprise+Server", "29", "Adobe+InDesign"],
      "examples_invalid": ["", "Enterprise Server"]
    },
    "version": {
      "case_sensitive": true,
      "examples_valid": ["1.0.0", "29", "CC"],
      "examples_invalid": ["latest"]
    },
    "tag_id": {
      "required": true,
      "guid_lowercase": true,
      "examples_valid": ["75b8c285-fa7b-485b-b199-4745e3004d0d", "org.fedoraproject.Fedora-29"],
      "examples_invalid": ["", "75B8C285-FA7B-485B-B199-4745E3004D0D"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:swid/{namespace}/{name}[@{version}]?tag_id={tag_id}",
      "description": "SWID tag with namespace and required tag_id",
      "example": "pkg:swid/Acme/example.com/Enterprise+Server@1.0.0?tag_id=75b8c285-fa7b-485b-b199-4745e3004d0d"
    },
    {
      "pattern": "pkg:swid/{name}[@{version}]?tag_id={tag_id}",
      "description": "SWID tag without namespace",
      "example": "pkg:swid/Fedora@29?tag_id=org.fedoraproject.Fedora-29"
    },
    {
      "pattern": "pkg:swid/{namespace}/{name}[@{version}]?tag_id={tag_id}&tag_version={version}",
      "description": "SWID tag with tag version",
      "example": "pkg:swid/Adobe%2BSystems%2BIncorporated/Adobe%2BInDesign@CC?tag_id=CreativeCloud-CS6-Win-GM-MUL&tag_version=1"
    }
  ],
  "anti_patterns": [
    "pkg:swid/Acme/example.com/Enterprise+Server@1.0.0",
    "pkg:swid/Fedora@29?tag_id=",
    "pkg:swid/Fedora@29?tag_id=75B8C285-FA7B-485B-B199-4745E3004D0D",
    "pkg:swid/",
    "pkg:swid"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Extract the namespace (first component after pkg:swid/)",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a software name component?",
        "yes": "Extract the name (component after namespace/ or after pkg:swid/ if no namespace)",
        "no": "Invalid PURL - name is required for swid"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Version is optional for swid"
      },
      {
        "question": "Is there a tag_id qualifier?",
        "yes": "Extract the tag_id",
        "no": "Invalid PURL - tag_id is required for swid"
      },
      {
        "question": "Are there other qualifiers?",
        "yes": "Parse additional key=value pairs",
        "no": "No additional qualifiers present"
      }
    ]
  },
  "context": {
    "ecosystem": "Software Identification",
    "package_manager": "SWID",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:swid/[{namespace}/]{name}[@{version}]?{qualifiers}",
    "versioning_system": "Software-specific versioning",
    "identification_system": "ISO-IEC 19770-2 Software Identification Tags",
    "repository_model": "No repository - SWID tags are self-contained"
  },
  "edge_cases": [
    {
      "case": "Namespace with two segments",
      "handling": "Namespace can have name and regid as two segments",
      "purl_impact": "Enables full identification of software creator"
    },
    {
      "case": "GUID vs non-GUID tag IDs",
      "handling": "GUIDs must be lowercase, non-GUIDs are case-aware but not case-sensitive",
      "purl_impact": "Ensures proper formatting of tag identifiers"
    },
    {
      "case": "Different tag creator",
      "handling": "Use tag_creator_name and tag_creator_regid when different from software creator",
      "purl_impact": "Accurately represents tag provenance"
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "SWID tags always have a namespace",
      "Version is always required",
      "tag_id is optional",
      "GUID tag IDs can be uppercase",
      "All SWID tags are stored in a repository"
    ],
    "key_facts_to_remember": [
      "Namespace is optional and can have up to two segments (name and regid)",
      "Software name is required and case-sensitive",
      "Version is optional and case-sensitive",
      "tag_id qualifier is always required",
      "GUID tag IDs must be lowercase"
    ],
    "common_mistakes_to_avoid": [
      "Omitting the required tag_id qualifier",
      "Using uppercase letters in GUID tag IDs",
      "Using more than two segments in namespace",
      "Forgetting that namespace is optional",
      "Treating SWID tags as repository-based packages"
    ]
  },
  "examples": [
    {
      "purl": "pkg:swid/Acme/example.com/Enterprise+Server@1.0.0?tag_id=75b8c285-fa7b-485b-b199-4745e3004d0d",
      "description": "SWID tag with namespace, version, and GUID tag ID"
    },
    {
      "purl": "pkg:swid/Fedora@29?tag_id=org.fedoraproject.Fedora-29",
      "description": "SWID tag without namespace but with version and tag ID"
    },
    {
      "purl": "pkg:swid/Adobe%2BSystems%2BIncorporated/Adobe%2BInDesign@CC?tag_id=CreativeCloud-CS6-Win-GM-MUL",
      "description": "SWID tag with percent-encoded namespace and non-GUID tag ID"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:swid/Acme/example.com/Enterprise+Server@1.0.0",
      "description": "Missing required tag_id qualifier",
      "violation": "qualifiers_definition.tag_id.requirement=required"
    },
    {
      "purl": "pkg:swid/Fedora@29?tag_id=",
      "description": "Empty tag_id qualifier - tag_id cannot be empty",
      "violation": "qualifiers_definition.tag_id must not be empty"
    },
    {
      "purl": "pkg:swid/Fedora@29?tag_id=75B8C285-FA7B-485B-B199-4745E3004D0D",
      "description": "GUID tag ID with uppercase letters - GUIDs must be lowercase",
      "violation": "qualifiers_definition.tag_id GUIDs must be lowercase"
    },
    {
      "purl": "pkg:swid/",
      "description": "Missing software name component - name is required for swid",
      "violation": "name_definition.requirement=required"
    },
    {
      "purl": "pkg:swid",
      "description": "Missing software name component - name is required for swid",
      "violation": "name_definition.requirement=required"
    }
  ],
  "note": "Use of known qualifiers key/value pairs such as download_url can be used to specify where the package was retrieved from.",
  "references": [
    {
      "title": "ISO/IEC 19770-2:2015 Software Identification Tag",
      "url": "https://www.iso.org/standard/65662.html"
    },
    {
      "title": "SWID Tag Guidance",
      "url": "https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-181.pdf"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-16"
  }
}