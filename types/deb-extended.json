{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/deb-extended-definition.json",
  "type": "deb",
  "type_name": "Debian package",
  "description": "Debian packages, Debian derivatives, and Ubuntu packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "lowercase",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "note": "There is no default package repository. The repository can be specified via the 'distro' or 'repository_url' qualifiers.",
    "supported_qualifiers": [
      "distro",
      "repository_url"
    ]
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "vendor",
    "note": "The namespace is the 'vendor' name such as 'debian' or 'ubuntu'. It must be lowercased.",
    "normalization_rules": [
      "It is not case sensitive and must be lowercased."
    ]
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "name",
    "note": "The package name. It must be lowercased.",
    "normalization_rules": [
      "It is not case sensitive and must be lowercased."
    ]
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version of the binary (or source) package."
  },
  "qualifiers_definition": [
    {
      "key": "arch",
      "requirement": "optional",
      "description": "The package architecture. The special value 'source' identifies a Debian source package. While optional, it is strongly recommended for disambiguating binary packages.",
      "examples": ["i386", "amd64", "arm64", "source", "all"]
    },
    {
      "key": "distro",
      "requirement": "optional",
      "description": "The distribution name, codename, or suite.",
      "examples": ["jessie", "stretch", "buster", "bullseye", "focal", "jammy"]
    },
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "Base URL for the package repository.",
      "examples": ["http://deb.debian.org/debian/", "http://archive.ubuntu.com/ubuntu/"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "examples_valid": ["debian", "ubuntu", "mint"],
      "examples_invalid": ["Debian", "Ubuntu"]
    },
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["curl", "dpkg", "attr", "dpkg-dev", "libssl1.1"],
      "examples_invalid": ["Curl", "package name"]
    },
    "version": {
      "format": "debian-version",
      "supports_epoch": true,
      "supports_revision": true,
      "examples_valid": ["7.50.3-1", "1.19.0.4", "1:2.4.47-2", "1:2.4.47-2+b1"],
      "examples_invalid": ["latest", "v1.0.0"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:deb/{vendor}/{name}@{version}?arch={arch}&distro={distro}",
      "description": "Debian package with architecture and distribution.",
      "example": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie"
    },
    {
      "pattern": "pkg:deb/{vendor}/{name}@{version}?arch=source",
      "description": "Source package identified by its architecture.",
      "example": "pkg:deb/debian/attr@1:2.4.47-2?arch=source"
    }
  ],
  "anti_patterns": [
    "pkg:deb/Debian/curl@7.50.3-1?arch=i386&distro=jessie",
    "pkg:deb/debian/Curl@7.50.3-1?arch=i386&distro=jessie",
    "pkg:deb/debian/curl",
    "pkg:deb"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a vendor/namespace component?",
        "yes": "Extract the vendor (first component after pkg:deb/)",
        "no": "Invalid PURL - vendor is required"
      },
      {
        "question": "Is there a package name component?",
        "yes": "Extract the package name (component after vendor/)",
        "no": "Invalid PURL - package name is required"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required"
      }
    ]
  },
  "context": {
    "ecosystem": "Debian/Ubuntu",
    "package_manager": "dpkg/apt",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:deb/{vendor}/{name}@{version}?{qualifiers}",
    "versioning_system": "Debian versioning with epoch and revision support.",
    "architecture_support": "Multiple architectures, including 'source' and 'all'.",
    "repository_model": "Distributed with no central default repository."
  },
  "edge_cases": [
    {
      "case": "Packages with epoch in version",
      "handling": "Epoch is represented as a number followed by a colon at the beginning of the version string.",
      "purl_impact": "The epoch must be preserved as it is the most significant part of version comparison."
    },
    {
      "case": "Source packages",
      "handling": "Use 'arch=source' to identify source packages.",
      "purl_impact": "Distinguishes between source and binary packages."
    },
    {
      "case": "Binary revisions",
      "handling": "Binary-specific revisions are suffixed with '+bN'.",
      "purl_impact": "The '+' character must be percent-encoded as '%2B' in the PURL version component."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "All deb packages use the 'debian' vendor.",
      "Package names can contain uppercase letters.",
      "Versions follow standard SemVer."
    ],
    "key_facts_to_remember": [
      "Vendor/namespace is required and must be lowercase.",
      "Package name is required, must be lowercase, and can contain hyphens.",
      "Version is required and follows the complex Debian versioning format.",
      "The 'arch' qualifier is optional but strongly recommended for identifying binary packages.",
      "Source packages are identified by 'arch=source'."
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in vendor or package name.",
      "Omitting the required version component.",
      "Forgetting to percent-encode the '+' character in binary revisions.",
      "Assuming a default repository URL exists."
    ]
  },
  "examples": [
    {
      "purl": "pkg:deb/debian/curl@7.50.3-1?arch=i386&distro=jessie",
      "description": "Debian curl package for i386 architecture in Jessie distribution."
    },
    {
      "purl": "pkg:deb/ubuntu/dpkg@1.19.0.4?arch=amd64",
      "description": "Ubuntu dpkg package for amd64 architecture."
    },
    {
      "purl": "pkg:deb/debian/attr@1:2.4.47-2?arch=source",
      "description": "Debian attr source package with epoch."
    },
    {
      "purl": "pkg:deb/debian/attr@1:2.4.47-2%2Bb1?arch=amd64",
      "description": "Debian attr binary package with epoch and binary revision."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:deb/Debian/curl@7.50.3-1?arch=i386&distro=jessie",
      "description": "Vendor with uppercase letters, which violates the lowercase requirement.",
      "violation": "namespace_definition requires lowercasing."
    },
    {
      "purl": "pkg:deb/debian/Curl@7.50.3-1?arch=i386&distro=jessie",
      "description": "Package name with uppercase letters, which violates the lowercase requirement.",
      "violation": "name_definition requires lowercasing."
    },
    {
      "purl": "pkg:deb/debian/curl",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:deb/debian",
      "description": "Missing name component, which is required.",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Debian Policy Manual",
      "url": "https://www.debian.org/doc/debian-policy/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}