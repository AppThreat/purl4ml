{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/cargo-extended-definition.json",
  "type": "cargo",
  "type_name": "Cargo",
  "description": "Cargo packages for Rust",
  "uri_compliance": {
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://crates.io/",
    "supported_repositories": [
      "https://crates.io/"
    ],
    "note": "Cargo packages are primarily hosted on crates.io"
  },
  "namespace_definition": {
    "requirement": "prohibited",
    "note": "there is no namespace"
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "name",
    "note": "The name is the package name in the Cargo ecosystem."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version following SemVer specification."
  },
  "validation_rules": {
    "name": {
      "format": "rust-package-name",
      "allowed_characters": "alphanumeric, hyphens, underscores",
      "no_leading_digits": true,
      "no_rust_keywords": true,
      "examples_valid": ["rand", "serde", "tokio", "actix-web"],
      "examples_invalid": ["123name", "struct", "package name", "package@name"]
    },
    "version": {
      "format": "semver",
      "examples_valid": ["0.7.2", "1.0.0", "2.33.0", "0.3.11"],
      "examples_invalid": ["1.0", "1.0.0.0", "latest", "v1.0.0"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:cargo/{name}@{version}",
      "description": "Standard Cargo package reference",
      "example": "pkg:cargo/rand@0.7.2"
    }
  ],
  "anti_patterns": [
    "pkg:cargo/namespace/rand@0.7.2",
    "pkg:cargo/RAND@0.7.2",
    "pkg:cargo/rand@latest",
    "pkg:cargo/rand",
    "pkg:cargo/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Invalid PURL - namespace is prohibited for cargo",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a name component?",
        "yes": "Extract the name (component after pkg:cargo/)",
        "no": "Invalid PURL - name is required for cargo"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for cargo"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?",
        "no": "No qualifiers present"
      }
    ]
  },
  "context": {
    "ecosystem": "Rust",
    "package_manager": "Cargo",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:cargo/{name}@{version}?{qualifiers}",
    "versioning_system": "Semantic Versioning (SemVer)",
    "naming_convention": "Rust package naming conventions with restrictions"
  },
  "edge_cases": [
    {
      "case": "Names with hyphens and underscores",
      "handling": "Both hyphens and underscores are allowed in package names",
      "purl_impact": "No special encoding required for these characters"
    },
    {
      "case": "Legacy packages with non-SemVer versions",
      "handling": "While rare, some legacy packages might not follow strict SemVer",
      "purl_impact": "Version should still be represented as-is without normalization"
    },
    {
      "case": "Private registry packages",
      "handling": "Use repository_url qualifier to specify non-crates.io registry",
      "purl_impact": "Allows referencing packages from alternative Cargo registries"
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "Cargo packages have namespaces",
      "Package names are case-insensitive",
      "Version can be omitted",
      "Package names can start with digits",
      "Package names can be Rust keywords"
    ],
    "key_facts_to_remember": [
      "Namespace is prohibited for cargo packages",
      "Package name is required and case-sensitive",
      "Version is required and follows SemVer",
      "Package names must follow Rust naming conventions",
      "All characters in package names are allowed as-is (no encoding)"
    ],
    "common_mistakes_to_avoid": [
      "Adding a namespace component",
      "Using non-SemVer version strings",
      "Using uppercase letters in package names (when they should be lowercase)",
      "Starting package names with digits",
      "Using Rust keywords as package names"
    ]
  },
  "examples": [
    {
      "purl": "pkg:cargo/rand@0.7.2",
      "description": "Random number generation library"
    },
    {
      "purl": "pkg:cargo/clap@2.33.0",
      "description": "Command line argument parser"
    },
    {
      "purl": "pkg:cargo/structopt@0.3.11",
      "description": "Command line argument parsing library"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:cargo/namespace/rand@0.7.2",
      "description": "Includes namespace component - namespace is prohibited for cargo",
      "violation": "namespace_definition.requirement=prohibited"
    },
    {
      "purl": "pkg:cargo/RAND@0.7.2",
      "description": "Package name with uppercase letters - while technically allowed, convention is lowercase",
      "violation": "Rust package naming convention recommends lowercase"
    },
    {
      "purl": "pkg:cargo/rand@latest",
      "description": "Non-SemVer version - versions must follow SemVer format",
      "violation": "version_definition requires SemVer format"
    },
    {
      "purl": "pkg:cargo/rand",
      "description": "Missing version component - version is required for cargo",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:cargo/",
      "description": "Missing package name component - name is required for cargo",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Cargo Book",
      "url": "https://doc.rust-lang.org/cargo/"
    },
    {
      "title": "Cargo Package Naming Conventions",
      "url": "https://doc.rust-lang.org/cargo/reference/manifest.html#the-name-field"
    },
    {
      "title": "Semantic Versioning",
      "url": "https://semver.org/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-16"
  }
}