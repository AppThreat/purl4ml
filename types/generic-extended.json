{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/generic-extended-definition.json",
  "type": "generic",
  "type_name": "Generic Package",
  "description": "The generic type is for plain, generic packages that do not fit anywhere else such as for \"upstream-from-distro\" packages. In particular this is handy for a plain version control repository such as a bare git repo in combination with a vcs_url.",
  "uri_compliance": {
    "namespace_encoding": "verbatim",
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": false,
    "note": "There is no default repository."
  },
  "namespace_definition": {
    "requirement": "optional",
    "encoding": "verbatim",
    "note": "There is no generic namespace definition."
  },
  "name_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "name",
    "note": "The name component is mandatory. In the worst case it can be a file or directory name."
  },
  "version_definition": {
    "requirement": "optional",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version when available. While any string is valid, specific and immutable version strings are recommended for precise identification."
  },
  "qualifiers_definition": [
    {
      "key": "download_url",
      "requirement": "optional",
      "description": "A URL to download the package.",
      "examples": ["https://openssl.org/source/openssl-1.1.0g.tar.gz"]
    },
    {
      "key": "checksum",
      "requirement": "optional",
      "description": "A checksum to verify the package integrity.",
      "examples": ["sha256:de4d501267da", "sha1:abc123", "md5:def456"]
    },
    {
      "key": "vcs_url",
      "requirement": "optional",
      "description": "A URL to a version control system repository.",
      "examples": ["git+https://git.fsfe.org/dxtr/bitwarderl@cc55108da32"]
    }
  ],
  "validation_rules": {
    "name": {
      "examples_valid": ["openssl", "bitwarderl", "my-package"],
      "examples_invalid": ["", "package/with/slashes"]
    },
    "version": {
      "examples_valid": ["1.1.10g", "2.0", "3.0.1-beta", "latest", "develop"],
      "examples_invalid": []
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:generic/{name}[@{version}]",
      "description": "Basic generic package reference.",
      "example": "pkg:generic/openssl@1.1.10g"
    },
    {
      "pattern": "pkg:generic/{name}[@{version}]?download_url={url}&checksum={checksum}",
      "description": "Generic package with download URL and checksum.",
      "example": "pkg:generic/openssl@1.1.10g?download_url=https://openssl.org/source/openssl-1.1.0g.tar.gz&checksum=sha256:de4d501267da"
    },
    {
      "pattern": "pkg:generic/{name}?vcs_url={url}",
      "description": "Generic package identified by a version control URL.",
      "example": "pkg:generic/bitwarderl?vcs_url=git%2Bhttps://git.fsfe.org/dxtr/bitwarderl%40cc55108da32"
    }
  ],
  "anti_patterns": [
    "pkg:generic/",
    "pkg:generic/openssl@"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Extract the namespace (first component after pkg:generic/)",
        "no": "Proceed assuming no namespace"
      },
      {
        "question": "Is there a name component?",
        "yes": "Extract the name.",
        "no": "Invalid PURL - name is required"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version.",
        "no": "No version specified; this is permitted."
      }
    ]
  },
  "context": {
    "ecosystem": "Generic",
    "package_manager": "None",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:generic/[{namespace}/]{name}[@{version}][?{qualifiers}]",
    "versioning_system": "None specified",
    "use_case": "Fallback for packages that do not fit other defined PURL types."
  },
  "edge_cases": [
    {
      "case": "Packages without a version",
      "handling": "The version component is optional and can be omitted.",
      "purl_impact": "Allows referencing packages without explicit version information."
    },
    {
      "case": "Packages identified by VCS URL",
      "handling": "Use the 'vcs_url' qualifier to point to a version control repository.",
      "purl_impact": "Enables referencing packages directly from version control, often without a version component in the PURL itself."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "Version is required.",
      "A specific versioning scheme is used."
    ],
    "key_facts_to_remember": [
      "The 'generic' type is a fallback and should be avoided if a more specific type applies.",
      "The name component is required.",
      "The version component is optional, and any string is valid.",
      "Qualifiers like 'download_url', 'checksum', and 'vcs_url' are used for identification."
    ],
    "common_mistakes_to_avoid": [
      "Using 'generic' when a more specific type like 'github' or 'deb' is more appropriate.",
      "Omitting the required name component.",
      "Forgetting to percent-encode special characters in qualifier values."
    ]
  },
  "examples": [
    {
      "purl": "pkg:generic/openssl@1.1.10g",
      "description": "Basic OpenSSL package reference."
    },
    {
      "purl": "pkg:generic/openssl@1.1.10g?download_url=https://openssl.org/source/openssl-1.1.0g.tar.gz&checksum=sha256:de4d501267da",
      "description": "OpenSSL package with download URL and checksum."
    },
    {
      "purl": "pkg:generic/bitwarderl?vcs_url=git%2Bhttps://git.fsfe.org/dxtr/bitwarderl%40cc55108da32",
      "description": "Package identified by a version control URL."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:generic/",
      "description": "Missing name component, which is required.",
      "violation": "name_definition.requirement=required"
    },
    {
      "purl": "pkg:generic/openssl@",
      "description": "Empty version component. If the '@' is present, a version must follow.",
      "violation": "Version must not be empty if specified."
    }
  ],
  "note": "When possible another or a new purl type should be used instead of using the generic type and eventually contributed back to this specification.",
  "references": [
    {
      "title": "Package URL Specification",
      "url": "https://github.com/package-url/purl-spec/blob/master/PURL-SPECIFICATION.rst"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}