{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/hex-extended-definition.json",
  "type": "hex",
  "type_name": "Hex",
  "description": "Hex packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "lowercase",
    "version_encoding": "verbatim",
    "subpath_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://repo.hex.pm",
    "supported_repositories": [
      "https://repo.hex.pm"
    ],
    "note": "Hex packages are hosted on the Hex package manager."
  },
  "namespace_definition": {
    "requirement": "optional",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "organization for private packages",
    "note": "The namespace is optional; it may be used to specify the organization for private packages on hex.pm. It must be lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "name",
    "note": "The name is the package name. It must be lowercased."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version. The format can be flexible, as shown by valid examples like '2.3.'."
  },
  "subpath_definition": {
    "requirement": "optional",
    "encoding": "verbatim",
    "native_name": "subpath",
    "note": "The subpath, represented as the URI fragment, is used to point to a specific file or directory within the package."
  },
  "qualifiers_definition": [
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "The base URL for a custom Hex repository.",
      "examples": ["https://myrepo.example.com"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "examples_valid": ["acme", "myorg", "company"],
      "examples_invalid": ["Acme", "MyOrg", "company/"]
    },
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["jason", "foo", "phoenix_html", "bar"],
      "examples_invalid": ["Jason", "foo bar", "foo@bar"]
    },
    "version": {
      "format": "hex-version",
      "examples_valid": ["1.1.2", "2.13.3", "1.2.3", "2.3."],
      "examples_invalid": ["latest", "v1.1.2"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:hex/{name}@{version}",
      "description": "Standard Hex package reference.",
      "example": "pkg:hex/jason@1.1.2"
    },
    {
      "pattern": "pkg:hex/{namespace}/{name}@{version}",
      "description": "Hex package with an organization namespace.",
      "example": "pkg:hex/acme/foo@2.3."
    },
    {
      "pattern": "pkg:hex/{name}@{version}?repository_url={url}",
      "description": "Hex package from a custom repository.",
      "example": "pkg:hex/bar@1.2.3?repository_url=https://myrepo.example.com"
    }
  ],
  "anti_patterns": [
    "pkg:hex/Acme/foo@2.3.0",
    "pkg:hex/acme/Foo@2.3.0",
    "pkg:hex/acme/foo@latest",
    "pkg:hex/acme/foo",
    "pkg:hex/acme/foo@"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Extract the namespace (first component after pkg:hex/)",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a package name component?",
        "yes": "Extract the package name",
        "no": "Invalid PURL - name is required"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?.",
        "no": "No qualifiers present."
      }
    ]
  },
  "context": {
    "ecosystem": "Elixir",
    "package_manager": "Hex",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:hex/[{namespace}/]{name}@{version}[#{subpath}][?{qualifiers}]",
    "versioning_system": "Hex versioning (SemVer-like, but can be flexible).",
    "private_packages": "Supports private packages via an optional organization namespace."
  },
  "edge_cases": [
    {
      "case": "Packages from custom repositories",
      "handling": "Use the 'repository_url' qualifier to specify the base URL of a non-default Hex repository.",
      "purl_impact": "Allows referencing packages from private or alternative Hex repositories."
    },
    {
      "case": "Private packages with an organization namespace",
      "handling": "Use the namespace component to specify the organization.",
      "purl_impact": "Enables referencing private packages on hex.pm."
    },
    {
      "case": "Versions with non-standard formats",
      "handling": "The version string is preserved as-is. Formats like '2.3.' are valid.",
      "purl_impact": "Allows for accurate representation of all valid version strings found on Hex."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "All Hex packages have a namespace.",
      "Package names can contain uppercase letters.",
      "Version can be omitted."
    ],
    "key_facts_to_remember": [
      "Namespace is optional and must be lowercase.",
      "Package name is required and must be lowercase.",
      "Version is required.",
      "The 'repository_url' qualifier can be used for custom repositories.",
      "Subpath is optional and points to specific files within packages."
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in the namespace or name.",
      "Omitting the required version component.",
      "Incorrectly assuming a strict SemVer format for the version."
    ]
  },
  "examples": [
    {
      "purl": "pkg:hex/jason@1.1.2",
      "description": "Jason JSON library package."
    },
    {
      "purl": "pkg:hex/acme/foo@2.3.",
      "description": "Private package with a non-standard version string."
    },
    {
      "purl": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js",
      "description": "Phoenix HTML package with a subpath to a specific file."
    },
    {
      "purl": "pkg:hex/bar@1.2.3?repository_url=https://myrepo.example.com",
      "description": "Package from a custom Hex repository specified by 'repository_url'."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:hex/Acme/foo@2.3.0",
      "description": "Namespace contains uppercase letters, which violates the lowercase requirement.",
      "violation": "namespace_definition requires lowercasing."
    },
    {
      "purl": "pkg:hex/acme/Foo@2.3.0",
      "description": "Package name contains uppercase letters, which violates the lowercase requirement.",
      "violation": "name_definition requires lowercasing."
    },
    {
      "purl": "pkg:hex/acme/foo",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Hex.pm",
      "url": "https://hex.pm/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}
