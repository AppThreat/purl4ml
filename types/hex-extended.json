{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/hex-extended-definition.json",
  "type": "hex",
  "type_name": "Hex",
  "description": "Hex packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "lowercase",
    "version_encoding": "verbatim",
    "subpath_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://repo.hex.pm",
    "supported_repositories": [
      "https://repo.hex.pm"
    ],
    "note": "Hex packages are hosted on the Hex package manager"
  },
  "namespace_definition": {
    "requirement": "optional",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "organization for private packages",
    "note": "The namespace is optional; it may be used to specify the organization for private packages on hex.pm. It is not case sensitive and must be lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "name",
    "note": "The name is not case sensitive and must be lowercased."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version following Hex versioning scheme."
  },
  "subpath_definition": {
    "requirement": "optional",
    "encoding": "verbatim",
    "native_name": "subpath",
    "note": "The subpath is used to point to a specific file or directory within the package."
  },
  "qualifiers_definition": [
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "Custom Hex repository URL for private packages",
      "examples": ["https://myrepo.example.com"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "examples_valid": ["acme", "myorg", "company"],
      "examples_invalid": ["Acme", "MyOrg", "company/"]
    },
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["jason", "foo", "phoenix_html", "bar"],
      "examples_invalid": ["Jason", "foo bar", "foo@bar"]
    },
    "version": {
      "format": "hex-version",
      "examples_valid": ["1.1.2", "2.13.3", "1.2.3"],
      "examples_invalid": ["", "latest", "v1.1.2", "2.3."]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:hex/{name}@{version}",
      "description": "Standard Hex package reference",
      "example": "pkg:hex/jason@1.1.2"
    },
    {
      "pattern": "pkg:hex/{namespace}/{name}@{version}",
      "description": "Hex package with organization namespace",
      "example": "pkg:hex/acme/foo@2.3.0"
    },
    {
      "pattern": "pkg:hex/{name}@{version}#{subpath}",
      "description": "Hex package with subpath to specific file",
      "example": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js"
    },
    {
      "pattern": "pkg:hex/{name}@{version}?repository_url={url}",
      "description": "Hex package from custom repository",
      "example": "pkg:hex/bar@1.2.3?repository_url=https://myrepo.example.com"
    }
  ],
  "anti_patterns": [
    "pkg:hex/Acme/foo@2.3.0",
    "pkg:hex/acme/Foo@2.3.0",
    "pkg:hex/acme/foo@latest",
    "pkg:hex/acme/foo",
    "pkg:hex/acme/foo@",
    "pkg:hex/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Extract the namespace (first component after pkg:hex/)",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a package name component?",
        "yes": "Extract the package name (component after namespace/ or after pkg:hex/ if no namespace)",
        "no": "Invalid PURL - name is required for hex"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for hex"
      },
      {
        "question": "Is there a subpath component?",
        "yes": "Extract everything after # as subpath",
        "no": "No subpath present"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?",
        "no": "No qualifiers present"
      }
    ]
  },
  "context": {
    "ecosystem": "Elixir",
    "package_manager": "Hex",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:hex/[{namespace}/]{name}@{version}[#{subpath}][?{qualifiers}]",
    "versioning_system": "Hex versioning (similar to SemVer)",
    "private_packages": "Supports private packages with organization namespace",
    "repository_model": "Centralized with repo.hex.pm as default, supports custom repositories"
  },
  "edge_cases": [
    {
      "case": "Private packages with organization namespace",
      "handling": "Use namespace component to specify organization",
      "purl_impact": "Enables referencing private packages on hex.pm"
    },
    {
      "case": "Packages from custom repositories",
      "handling": "Use repository_url qualifier to specify non-default repository",
      "purl_impact": "Allows referencing packages from private Hex repositories"
    },
    {
      "case": "Referencing specific files within packages",
      "handling": "Use subpath to point to specific files or directories",
      "purl_impact": "Enables fine-grained reference to package contents"
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "All Hex packages have a namespace",
      "Package names can contain uppercase letters",
      "Version can be omitted",
      "All packages are on the public Hex repository",
      "Subpath is always required"
    ],
    "key_facts_to_remember": [
      "Namespace is optional and represents organization for private packages",
      "Package name is required and must be lowercase",
      "Version is required and follows Hex versioning",
      "Subpath is optional and points to specific files within packages",
      "Custom repositories use repository_url qualifier"
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in namespace or package name",
      "Omitting the required version component",
      "Using 'latest' as version (not a specific version)",
      "Forgetting to encode special characters in URLs",
      "Confusing namespace with repository_url"
    ]
  },
  "examples": [
    {
      "purl": "pkg:hex/jason@1.1.2",
      "description": "Jason JSON library package"
    },
    {
      "purl": "pkg:hex/acme/foo@2.3.0",
      "description": "Private package with organization namespace"
    },
    {
      "purl": "pkg:hex/phoenix_html@2.13.3#priv/static/phoenix_html.js",
      "description": "Phoenix HTML package with subpath to specific JavaScript file"
    },
    {
      "purl": "pkg:hex/bar@1.2.3?repository_url=https://myrepo.example.com",
      "description": "Package from custom Hex repository"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:hex/Acme/foo@2.3.0",
      "description": "Namespace with uppercase letters - violates lowercase requirement",
      "violation": "namespace_definition.case_sensitive=false and namespace_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:hex/acme/Foo@2.3.0",
      "description": "Package name with uppercase letters - violates lowercase requirement",
      "violation": "name_definition.case_sensitive=false and name_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:hex/acme/foo@latest",
      "description": "Non-specific version - 'latest' is not a valid Hex version",
      "violation": "version_definition requires a valid version"
    },
    {
      "purl": "pkg:hex/acme/foo",
      "description": "Missing version component - version is required for hex",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:hex/acme/foo@",
      "description": "Empty version component - version cannot be empty",
      "violation": "version_definition requires a valid version"
    },
    {
      "purl": "pkg:hex/",
      "description": "Missing package name component - name is required for hex",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Hex Documentation",
      "url": "https://hexdocs.pm/"
    },
    {
      "title": "Hex.pm",
      "url": "https://hex.pm/"
    },
    {
      "title": "Elixir Package Management",
      "url": "https://elixir-lang.org/getting-started/mix-otp/dependencies-and-umbrella-projects.html"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-16"
  }
}