{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/rpm-extended-definition.json",
  "type": "rpm",
  "type_name": "RPM",
  "description": "RPM packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "note": "There is no default package repository. This should be implied from the 'distro' qualifier or specified using the 'repository_url' qualifier.",
    "supported_qualifiers": [
      "distro",
      "repository_url"
    ]
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "vendor",
    "note": "The namespace is the distribution vendor, such as 'fedora' or 'centos'. It must be present and lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "name",
    "note": "The name of the RPM package. It is case-sensitive."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version-release",
    "note": "The version, which is the combined version and release string of an RPM (e.g., '7.50.3-1.fc25')."
  },
  "qualifiers_definition": [
    {
      "key": "arch",
      "requirement": "required",
      "description": "The package architecture.",
      "examples": ["i386", "x86_64", "noarch", "src"]
    },
    {
      "key": "epoch",
      "requirement": "optional",
      "description": "The epoch of the package. While optional in the purl, it is a critical part of the package version and should be included whenever it is not '0'.",
      "examples": ["1", "2", "7"]
    },
    {
      "key": "distro",
      "requirement": "optional",
      "description": "The full distribution string, which provides more specific context than the vendor namespace.",
      "examples": ["fedora-25", "centos-7", "opensuse-leap-15.2"]
    },
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "The base URL of the package repository.",
      "examples": ["https://download.fedoraproject.org/pub/fedora/linux/releases/25/Everything/x86_64/os/"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "examples_valid": ["fedora", "opensuse", "centos"],
      "examples_invalid": ["Fedora", "OpenSUSE", "centos/"]
    },
    "name": {
      "case_sensitive": true,
      "examples_valid": ["curl", "httpd", "postgresql-server"],
      "examples_invalid": ["", "curl/", "curl@name"]
    },
    "version": {
      "format": "rpm-version-release",
      "examples_valid": ["7.50.3-1.fc25", "4.22.10-1.el6"],
      "examples_invalid": ["", "latest", "v7.50.3-1.fc25"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:rpm/{vendor}/{name}@{version}?arch={arch}&distro={distro}",
      "description": "Standard RPM package with architecture and distribution.",
      "example": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25"
    },
    {
      "pattern": "pkg:rpm/{vendor}/{name}@{version}?epoch={epoch}&arch={arch}",
      "description": "RPM package with epoch and architecture.",
      "example": "pkg:rpm/centos/centerim@4.22.10-1.el6?epoch=1&arch=i686"
    }
  ],
  "anti_patterns": [
    "pkg:rpm/Fedora/curl@7.50.3-1.fc25?arch=i386",
    "pkg:rpm/fedora/curl@7.50.3-1.fc25",
    "pkg:rpm/curl@7.50.3-1.fc25?arch=i386",
    "pkg:rpm/fedora/curl",
    "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386#subpath"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a vendor (namespace)?",
        "yes": "Extract and lowercase the vendor.",
        "no": "Invalid PURL - vendor is required."
      },
      {
        "question": "Is there a package name?",
        "yes": "Extract the package name.",
        "no": "Invalid PURL - name is required."
      },
      {
        "question": "Is there a version?",
        "yes": "Extract the version string.",
        "no": "Invalid PURL - version is required."
      },
      {
        "question": "Is the 'arch' qualifier present?",
        "yes": "Parse all qualifiers.",
        "no": "Invalid PURL - 'arch' qualifier is required."
      }
    ]
  },
  "context": {
    "ecosystem": "Linux",
    "package_manager": "RPM",
    "versioning_system": "RPM versioning (epoch:version-release)",
    "architecture_support": "Architecture is a mandatory component of the identifier."
  },
  "edge_cases": [
    {
      "case": "Packages with an epoch",
      "handling": "The 'epoch' qualifier must be used. An epoch of 0 is default and can be omitted, but any other value must be included for accurate version comparison.",
      "purl_impact": "Ensures correct identification of packages where the epoch has been incremented."
    },
    {
      "case": "Source RPMs (SRPMs)",
      "handling": "Use arch=src to identify source packages.",
      "purl_impact": "Clearly distinguishes between binary and source packages."
    },
    {
      "case": "Modular RPMs (e.g., from RHEL 8+)",
      "handling": "This schema does not currently have a standard way to represent module streams. Users should adopt a convention, for example, by including the stream in the package name (e.g., 'pkg:rpm/fedora/postgresql:12@...').",
      "purl_impact": "This is an area for future standardization. Current implementations may not handle this case consistently."
    }
  ],
  "llm_guidance": {
    "key_facts_to_remember": [
      "A vendor (namespace) is required and must be lowercase.",
      "A package name is required and is case-sensitive.",
      "A version (version-release) is required.",
      "The 'arch' qualifier is required.",
      "The 'epoch' qualifier is optional but critical for correctness when present."
    ]
  },
  "examples": [
    {
      "purl": "pkg:rpm/fedora/curl@7.50.3-1.fc25?arch=i386&distro=fedora-25",
      "description": "Fedora curl package for the i386 architecture."
    },
    {
      "purl": "pkg:rpm/centos/centerim@4.22.10-1.el6?arch=i686&epoch=1",
      "description": "CentOS centerim package for the i686 architecture with an epoch of 1."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:rpm/Fedora/curl@7.50.3-1.fc25?arch=i386",
      "description": "Vendor contains uppercase letters.",
      "violation": "namespace_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:rpm/fedora/curl@7.50.3-1.fc25",
      "description": "Missing required 'arch' qualifier.",
      "violation": "qualifiers_definition.arch.requirement=required"
    },
    {
      "purl": "pkg:rpm/curl@7.50.3-1.fc25?arch=i386",
      "description": "Missing required vendor (namespace).",
      "violation": "namespace_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "RPM Documentation",
      "url": "https://rpm.org/"
    },
    {
      "title": "Fedora Packaging Guidelines",
      "url": "https://docs.fedoraproject.org/en-US/packaging-guidelines/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}