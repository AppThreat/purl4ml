{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/composer-extended-definition.json",
  "type": "composer",
  "type_name": "Composer",
  "description": "Composer PHP packages",
  "uri_compliance": {
    "namespace_encoding": "lowercase",
    "name_encoding": "lowercase",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://packagist.org",
    "supported_repositories": [
      "https://packagist.org"
    ],
    "note": "Composer packages are primarily hosted on Packagist"
  },
  "namespace_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "vendor",
    "note": "The namespace is the vendor. The namespace is not case sensitive and must be lowercased."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "name",
    "note": "The name is not case sensitive and must be lowercased. Private, local packages may have no name, but PURLs cannot be created for these."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version following semantic versioning."
  },
  "qualifiers_definition": [
    {
      "key": "repository_url",
      "requirement": "optional",
      "description": "Custom repository URL for private or third-party repositories",
      "examples": ["https://packages.example.com"]
    }
  ],
  "validation_rules": {
    "namespace": {
      "lowercase_required": true,
      "examples_valid": ["laravel", "symfony", "zendframework"],
      "examples_invalid": ["Laravel", "Symfony", "zend framework"]
    },
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["laravel", "console", "http-foundation"],
      "examples_invalid": ["Laravel", "console app", "http/foundation"]
    },
    "version": {
      "format": "semver",
      "examples_valid": ["5.5.0", "1.0.0", "2.1.3"],
      "examples_invalid": ["latest", "v5.5.0", "5.5"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:composer/{vendor}/{name}@{version}",
      "description": "Standard Composer package reference",
      "example": "pkg:composer/laravel/laravel@5.5.0"
    },
    {
      "pattern": "pkg:composer/{vendor}/{name}@{version}?repository_url={url}",
      "description": "Composer package from custom repository",
      "example": "pkg:composer/mycompany/mypackage@1.0.0?repository_url=https://packages.mycompany.com"
    }
  ],
  "anti_patterns": [
    "pkg:composer/Laravel/laravel@5.5.0",
    "pkg:composer/laravel/Laravel@5.5.0",
    "pkg:composer/laravel/laravel@latest",
    "pkg:composer/laravel/laravel",
    "pkg:composer/laravel",
    "pkg:composer"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a vendor/namespace component?",
        "yes": "Extract the vendor (first component after pkg:composer/)",
        "no": "Invalid PURL - vendor is required for composer"
      },
      {
        "question": "Is there a package name component?",
        "yes": "Extract the package name (component after vendor/)",
        "no": "Invalid PURL - package name is required for composer"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for composer"
      },
      {
        "question": "Are there qualifiers?",
        "yes": "Parse key=value pairs after ?",
        "no": "No qualifiers present"
      }
    ]
  },
  "context": {
    "ecosystem": "PHP",
    "package_manager": "Composer",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:composer/{vendor}/{name}@{version}?{qualifiers}",
    "versioning_system": "Semantic Versioning (SemVer)",
    "naming_convention": "Vendor/package name convention with lowercase requirements"
  },
  "edge_cases": [
    {
      "case": "Private packages without public name",
      "handling": "These packages cannot be represented as PURLs",
      "purl_impact": "Only packages with a valid name can have PURLs"
    },
    {
      "case": "Packages from private repositories",
      "handling": "Use repository_url qualifier to specify non-Packagist repository",
      "purl_impact": "Allows referencing packages from private or third-party repositories"
    },
    {
      "case": "Dev versions",
      "handling": "Development versions follow SemVer with stability suffixes",
      "purl_impact": "Version should include stability suffix when present (e.g., 1.0.0-dev)"
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "Composer packages don't require a vendor",
      "Package names can contain uppercase letters",
      "Version can be omitted",
      "All packages are on Packagist",
      "Package names can contain spaces"
    ],
    "key_facts_to_remember": [
      "Vendor/namespace is required and must be lowercase",
      "Package name is required and must be lowercase",
      "Version is required and follows SemVer",
      "Private packages without a name cannot have PURLs",
      "Custom repositories use repository_url qualifier"
    ],
    "common_mistakes_to_avoid": [
      "Using uppercase letters in vendor or package name",
      "Omitting the required version component",
      "Forgetting to include vendor namespace",
      "Using non-SemVer version strings",
      "Assuming all packages are publicly available on Packagist"
    ]
  },
  "examples": [
    {
      "purl": "pkg:composer/laravel/laravel@5.5.0",
      "description": "Laravel PHP framework"
    },
    {
      "purl": "pkg:composer/symfony/console@5.4.0",
      "description": "Symfony Console component"
    },
    {
      "purl": "pkg:composer/zendframework/zend-diactoros@2.3.0",
      "description": "Zend Diactoros PSR-7 implementation"
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:composer/Laravel/laravel@5.5.0",
      "description": "Vendor with uppercase letters - violates lowercase requirement",
      "violation": "namespace_definition.case_sensitive=false and namespace_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:composer/laravel/Laravel@5.5.0",
      "description": "Package name with uppercase letters - violates lowercase requirement",
      "violation": "name_definition.case_sensitive=false and name_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:composer/laravel/laravel@latest",
      "description": "Non-SemVer version - versions must follow SemVer format",
      "violation": "version_definition requires SemVer format"
    },
    {
      "purl": "pkg:composer/laravel/laravel",
      "description": "Missing version component - version is required for composer",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:composer/laravel",
      "description": "Missing package name component - package name is required for composer",
      "violation": "name_definition.requirement=required"
    },
    {
      "purl": "pkg:composer",
      "description": "Missing vendor component - vendor is required for composer",
      "violation": "namespace_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "Composer Documentation",
      "url": "https://getcomposer.org/doc/"
    },
    {
      "title": "Packagist",
      "url": "https://packagist.org/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-16"
  }
}