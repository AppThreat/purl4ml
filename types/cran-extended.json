{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/cran-extended-definition.json",
  "type": "cran",
  "type_name": "CRAN",
  "description": "CRAN R packages",
  "uri_compliance": {
    "name_encoding": "verbatim",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://cran.r-project.org",
    "supported_repositories": [
      "https://cran.r-project.org"
    ],
    "note": "CRAN packages are hosted on the Comprehensive R Archive Network."
  },
  "namespace_definition": {
    "requirement": "prohibited",
    "note": "There is no namespace for CRAN packages."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": true,
    "encoding": "verbatim",
    "native_name": "name",
    "note": "The name is the package name. It is case-sensitive, but there cannot be two packages on CRAN with the same name ignoring case, so the canonical case MUST be used."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the package version."
  },
  "qualifiers_definition": [],
  "validation_rules": {
    "name": {
      "case_sensitive": true,
      "unique_case_insensitive": true,
      "examples_valid": ["A3", "rJava", "caret"],
      "examples_invalid": ["A 3", "r@Java"]
    },
    "version": {
      "format": "cran-version",
      "supports_hyphen": true,
      "examples_valid": ["1.0.0", "1.0-4", "6.0-88"],
      "examples_invalid": ["latest", "v1.0.0"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:cran/{name}@{version}",
      "description": "Standard CRAN package reference.",
      "example": "pkg:cran/A3@1.0.0"
    }
  ],
  "anti_patterns": [
    "pkg:cran/namespace/A3@1.0.0",
    "pkg:cran/a3@1.0.0",
    "pkg:cran/A3",
    "pkg:cran/A3@",
    "pkg:cran/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Invalid PURL - namespace is prohibited for cran",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a name component?",
        "yes": "Extract the name (component after pkg:cran/)",
        "no": "Invalid PURL - name is required for cran"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for cran"
      }
    ]
  },
  "context": {
    "ecosystem": "R",
    "package_manager": "CRAN",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:cran/{name}@{version}",
    "versioning_system": "CRAN-specific versioning with hyphen support.",
    "naming_convention": "Package names are case-sensitive, but must adhere to a single canonical case as per the case-insensitive uniqueness rule."
  },
  "edge_cases": [
    {
      "case": "Case sensitivity in package names",
      "handling": "Package names are case-sensitive. Due to the case-insensitive uniqueness rule, only the canonical spelling of a package name is valid in a PURL.",
      "purl_impact": "Using a non-canonical case for the name component renders the PURL invalid."
    },
    {
      "case": "Version formats with hyphens",
      "handling": "Versions can contain hyphens, which are significant.",
      "purl_impact": "Hyphens in versions are a valid part of the version string and must be preserved."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "CRAN packages have namespaces.",
      "Package names are case-insensitive.",
      "Version can be omitted."
    ],
    "key_facts_to_remember": [
      "Namespace is prohibited.",
      "Package name is required and MUST use the canonical case-sensitive spelling.",
      "Version is required and can contain hyphens."
    ],
    "common_mistakes_to_avoid": [
      "Adding a namespace component.",
      "Omitting the required version component.",
      "Using an incorrect, non-canonical case for a package name, which makes the PURL invalid."
    ]
  },
  "examples": [
    {
      "purl": "pkg:cran/A3@1.0.0",
      "description": "A3 package for R."
    },
    {
      "purl": "pkg:cran/rJava@1.0-4",
      "description": "rJava package with a hyphen in the version."
    },
    {
      "purl": "pkg:cran/caret@6.0-88",
      "description": "caret package for machine learning."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:cran/namespace/A3@1.0.0",
      "description": "Includes a namespace component, which is prohibited.",
      "violation": "namespace_definition.requirement=prohibited"
    },
    {
      "purl": "pkg:cran/a3@1.0.0",
      "description": "Package name with incorrect (non-canonical) case. PURLs must use the canonical case.",
      "violation": "CRAN enforces unique package names case-insensitively; only the canonical case is valid."
    },
    {
      "purl": "pkg:cran/A3",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:cran/A3@",
      "description": "Empty version component. A version must follow the '@' symbol.",
      "violation": "Version must not be empty."
    },
    {
      "purl": "pkg:cran/",
      "description": "Missing name component, which is required.",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "CRAN",
      "url": "https://cran.r-project.org/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}