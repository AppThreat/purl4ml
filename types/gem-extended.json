{
  "$schema": "https://raw.githubusercontent.com/AppThreat/purl4ml/refs/heads/main/schemas/purl-type-extended-definition.schema.json",
  "$id": "https://packageurl.org/types/gem-extended-definition.json",
  "type": "gem",
  "type_name": "RubyGems",
  "description": "RubyGems",
  "uri_compliance": {
    "name_encoding": "lowercase",
    "version_encoding": "verbatim"
  },
  "repository": {
    "use_repository": true,
    "default_repository_url": "https://rubygems.org",
    "supported_repositories": [
      "https://rubygems.org"
    ],
    "note": "RubyGems are hosted on the official RubyGems repository."
  },
  "namespace_definition": {
    "requirement": "prohibited",
    "note": "There is no namespace for RubyGems."
  },
  "name_definition": {
    "requirement": "required",
    "case_sensitive": false,
    "encoding": "lowercase",
    "native_name": "name",
    "note": "The name is the gem name and must be lowercase."
  },
  "version_definition": {
    "requirement": "required",
    "encoding": "verbatim",
    "native_name": "version",
    "note": "The version is the gem version, following the RubyGems versioning scheme."
  },
  "qualifiers_definition": [
    {
      "key": "platform",
      "native_name": "platform",
      "requirement": "optional",
      "default_value": "ruby",
      "description": "A qualifier used to specify an alternative platform, such as 'java' for JRuby. The implied default is 'ruby' for the standard Ruby MRI.",
      "examples": ["ruby", "java", "mswin32", "mingw32"]
    }
  ],
  "validation_rules": {
    "name": {
      "lowercase_required": true,
      "no_spaces": true,
      "examples_valid": ["ruby-advisory-db-check", "jruby-launcher", "rails"],
      "examples_invalid": ["Ruby-Advisory-DB-Check", "ruby advisory db check", "ruby@advisory"]
    },
    "version": {
      "format": "rubygem-version",
      "examples_valid": ["0.12.4", "1.1.2", "6.1.4"],
      "examples_invalid": ["latest", "v0.12.4"]
    }
  },
  "common_patterns": [
    {
      "pattern": "pkg:gem/{name}@{version}",
      "description": "Standard RubyGem (implicitly for the 'ruby' platform).",
      "example": "pkg:gem/ruby-advisory-db-check@0.12.4"
    },
    {
      "pattern": "pkg:gem/{name}@{version}?platform={platform}",
      "description": "RubyGem with a specific platform.",
      "example": "pkg:gem/jruby-launcher@1.1.2?platform=java"
    }
  ],
  "anti_patterns": [
    "pkg:gem/namespace/ruby-advisory-db-check@0.12.4",
    "pkg:gem/Ruby-Advisory-DB-Check@0.12.4",
    "pkg:gem/ruby-advisory-db-check",
    "pkg:gem/ruby-advisory-db-check@",
    "pkg:gem/"
  ],
  "parsing_decision_tree": {
    "steps": [
      {
        "question": "Is there a namespace component?",
        "yes": "Invalid PURL - namespace is prohibited for gem",
        "no": "Proceed with name parsing"
      },
      {
        "question": "Is there a gem name component?",
        "yes": "Extract and lowercase the name.",
        "no": "Invalid PURL - name is required for gem"
      },
      {
        "question": "Is there a version component?",
        "yes": "Extract everything after @ as version",
        "no": "Invalid PURL - version is required for gem"
      },
      {
        "question": "Is there a 'platform' qualifier?",
        "yes": "Parse the platform value.",
        "no": "No platform specified; defaults to 'ruby'."
      }
    ]
  },
  "context": {
    "ecosystem": "Ruby",
    "package_manager": "RubyGems",
    "url_scheme": "pkg",
    "hierarchical_structure": "pkg:gem/{name}@{version}[?{qualifiers}]",
    "versioning_system": "RubyGems versioning",
    "platform_support": "Multiple Ruby implementations (MRI, JRuby, etc.) via the 'platform' qualifier."
  },
  "edge_cases": [
    {
      "case": "Gems for alternative Ruby implementations",
      "handling": "Use the 'platform' qualifier to specify non-MRI implementations (e.g., 'java' for JRuby).",
      "purl_impact": "Allows disambiguation between gems for different Ruby platforms."
    },
    {
      "case": "Default platform",
      "handling": "If the 'platform' qualifier is omitted, it defaults to 'ruby'.",
      "purl_impact": "A PURL without a platform qualifier is a valid and complete identifier for a standard Ruby MRI gem."
    }
  ],
  "llm_guidance": {
    "do_not_assume": [
      "RubyGems have namespaces.",
      "Gem names are case-sensitive.",
      "Version is optional."
    ],
    "key_facts_to_remember": [
      "Namespace is prohibited.",
      "Gem name is required and must be lowercase.",
      "Version is required.",
      "The 'platform' qualifier is optional and defaults to 'ruby'."
    ],
    "common_mistakes_to_avoid": [
      "Adding a namespace component.",
      "Using uppercase letters in a gem name.",
      "Omitting the required version component.",
      "Forgetting that the 'platform' qualifier defaults to 'ruby' if not specified."
    ]
  },
  "examples": [
    {
      "purl": "pkg:gem/ruby-advisory-db-check@0.12.4",
      "description": "Ruby advisory database checker gem."
    },
    {
      "purl": "pkg:gem/jruby-launcher@1.1.2?platform=java",
      "description": "JRuby launcher gem for the Java platform."
    },
    {
      "purl": "pkg:gem/rails@6.1.4",
      "description": "Rails web framework gem."
    }
  ],
  "incorrect_examples": [
    {
      "purl": "pkg:gem/namespace/ruby-advisory-db-check@0.12.4",
      "description": "Includes a namespace component, which is prohibited.",
      "violation": "namespace_definition.requirement=prohibited"
    },
    {
      "purl": "pkg:gem/Ruby-Advisory-DB-Check@0.12.4",
      "description": "Gem name contains uppercase letters, which violates the lowercase requirement.",
      "violation": "name_definition.encoding=lowercase"
    },
    {
      "purl": "pkg:gem/ruby-advisory-db-check",
      "description": "Missing version component, which is required.",
      "violation": "version_definition.requirement=required"
    },
    {
      "purl": "pkg:gem/ruby-advisory-db-check@",
      "description": "Empty version component. A version must follow the '@' symbol.",
      "violation": "Version must not be empty."
    },
    {
      "purl": "pkg:gem/",
      "description": "Missing gem name component, which is required.",
      "violation": "name_definition.requirement=required"
    }
  ],
  "references": [
    {
      "title": "RubyGems Guides",
      "url": "https://guides.rubygems.org/"
    }
  ],
  "metadata": {
    "last_updated": "2025-08-23"
  }
}